    {% include 'header.html' %}

    <!--begin::App Main-->
    <main class="app-main" style="display: flex;">
        <div class="app-content-header">
            <!--begin::Container-->
            <div class="container-fluid">
                <!--begin::Row Header-->
                <div class="row">
                    <div class="col-sm-6">
                        <h3 class="mb-0">Form Claim</h3>
                    </div>
                    <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-end">
                            <li class="breadcrumb-item"><a href="/formclaim">Add Claim</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Claim</li>
                        </ol>
                    </div>
                </div>
                <!--end::Row Header-->
                <!-- Begin Content -->
                <div class="row">
                    <!-- Form Kiri -->
                    <form action="{{ url_for('klaim.saveformclaim') }}" method="POST">
                        <div class="row">

                            <!-- Kolom Kiri -->
                            <div class="col-md-6">
                                <div class="card card-primary card-outline mb-4">
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <label for="claim_id" class="mb-0 form-label">Claim ID (Auto Generate)</label>
                                            <input type="text" class="form-control" id="claim_id" name="claim_id"
                                                value="{{ next_claim_id }}" readonly />
                                        </div>
                                        <div class="mb-2">
                                            <label for="claim_status" class="mb-0 form-label">Claim Status</label>
                                            <select class="form-control" id="claim_status" name="claim_status" required>
                                                <option value="" disabled selected>-- Select Claim Status --</option>
                                                <option value="Solved">Solved</option>
                                                <option value="Reject">Reject</option>
                                                <option value="Closed by Acquirer">Closed by Acquirer</option>
                                                <option value="Already Web Claim">Already Web Claim</option>
                                                <option value="Closed Success">Closed Success</option>
                                                <option value="Active">Active</option>
                                                <option value="Close by System">Close by System</option>
                                                <option value="Already Email Claim">Already Email Claim</option>
                                                <option value="Already Pro-Active">Already Pro-Active</option>
                                                <option value="Cancelled by Acq">Cancelled by Acq</option>
                                                <option value="On Process">On Process</option>
                                                <option value="Not Yet Inputed">Not Yet Inputed</option>
                                                <option value="Process on Next Day">Process on Next Day</option>
                                                <option value="Change to be Re-Active">Change to be Re-Active</option>
                                                <option value="Rejected by Acq">Rejected by Acq</option>
                                                <option value="Pending Investigation">Pending Investigation</option>
                                                <option value="Waiting Approve">Waiting Approve</option>
                                                <option value="Waiting Reject">Waiting Reject</option>
                                                <option value="Cancelled by ALTO">Cancelled by ALTO</option>
                                                <option value="Duplicate/Double">Duplicate/Double</option>
                                                <option value="Crosscheck">Crosscheck</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="claim_number" class="mb-0 form-label"></label>
                                            <input type="text" class="form-control" id="claim_number" name="claim_number"
                                                placeholder="Claim Number Ex: WDL/20250125/33" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="claim_inisiator" class="form-label"></label>
                                            <input type="text" class="form-control" id="claim_inisiator"
                                                name="claim_inisiator"
                                                placeholder="Claim Number Inisiator Ex: 004205/ATMi-Klaim/25/01/25"
                                                />
                                        </div>
                                        <div class="mb-2">
                                            <label for="claim_type" class="mb-0 form-label">Claim Type</label>
                                            <select class="form-control" id="claim_type" name="claim_type" required>
                                                <option value="" disabled selected>-- Select Claim Type --</option>
                                                <option value="Web Claim">Web Claim</option>
                                                <option value="Web Claim AJ">Web Claim AJ</option>
                                                <option value="Pro Active Claim">Pro Active Claim</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="terminal" class="form-label"></label>
                                            <input type="text" class="form-control" id="terminal" name="terminal"
                                                placeholder="Terminal Ex: 1000001" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="no_acq" class="form-label"></label>
                                            <input type="text" class="form-control" id="no_acq" name="no_acq"
                                                placeholder="No. Acquirer Ex: 10010" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="no_pan" class="form-label"></label>
                                            <input type="text" class="form-control" id="no_pan" name="no_pan"
                                                placeholder="No. PAN Ex: 232221929122234" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="no_receipt" class="form-label"></label>
                                            <input type="text" class="form-control" id="no_receipt" name="no_receipt"
                                                placeholder="No. Receipt Ex: 1001" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="trx_date" class="form-label">Transaction Date</label>
                                            <input type="date" class="form-control" id="trx_date" name="trx_date"
                                                placeholder="Transaction Date" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="trx_time" class="form-label">Transaction Time</label>
                                            <input type="time" class="form-control" id="trx_time" name="trx_time"
                                                placeholder="Transaction Time" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="due_date" class="form-label">Due Date</label>
                                            <input type="date" class="form-control" id="due_date" name="due_date"
                                                placeholder="Due Date" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Form Kanan -->
                            <div class="col-md-6">
                                <div class="card card-primary card-outline mb-4">
                                    <div class="card-body">
                                        <div class="mb-2">
                                            <label for="claim_date" class="form-label">Claim Date</label>
                                            <input type="date" class="form-control" id="claim_date" name="claim_date"
                                                placeholder="Claim Date" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="trx_amount" class="form-label"></label>
                                            <input type="text" class="form-control" id="trx_amount" name="trx_amount"
                                                placeholder="Transaction Amount" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="description" class="form-label"></label>
                                            <input type="text" class="form-control" id="description" name="description"
                                                placeholder="Description" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="user" class="form-label"></label>
                                            <input type="text" class="form-control" id="user" name="user"
                                                value="{{ current_user }}" readonly>
                                            <input type="hidden" name="user" value="{{ current_user }}">
                                        </div>
                                        <div class="mb-2">
                                            <label for="reference" class="form-label"></label>
                                            <input type="text" class="form-control" id="reference" name="reference"
                                                placeholder="Reference" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="week_report" class="form-label"></label>
                                            <input type="text" class="form-control" id="week_report" name="week_report"
                                                placeholder="Week report Ex: W2-May-25" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="close_claim" class="form-label">Close Claim Date</label>
                                            <input type="date" class="form-control" id="close_claim" name="close_claim"
                                                placeholder="Claim Claim Date" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="bin" class="form-label"></label>
                                            <input type="text" class="form-control" id="bin" name="bin"
                                                placeholder="BIN Ex: 4110" required />
                                        </div>
                                        <div class="mb-2">
                                            <label for="routing" class="form-label">Routing</label>
                                            <select class="form-control" id="routing" name="routing" required>
                                                <option value="" disabled selected>-- Select Routing --</option>
                                                <option value="ALTO">ALTO</option>
                                                <option value="ARTAJASA">ARTAJASA</option>
                                            </select>
                                        </div>
                                        <div class="mb-2">
                                            <label for="claim_entry_boa" class="form-label">Claim Entry BOA</label>
                                            <select class="form-control" id="claim_entry_boa" name="claim_entry_boa"
                                                required>
                                                <option value="" disabled selected>-- Select BOA --</option>
                                                <option value="Solved">Solved</option>
                                                <option value="Rejected">Rejected</option>
                                                <option value="On Process">On Process</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="remarks" class="form-label"></label>
                                            <input type="text" class="form-control" id="remarks" name="remarks"
                                                placeholder="Remarks" required />
                                        </div>
                                        <!-- btn submit -->
                                        <div class="row">
                                            <div class="">
                                                <button type="submit" class="btn btn-primary">Submit</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- upload -->
                        <!-- <label for="">Upload proof of transaction</label>
                                    <div class="input-group mb-3">
                                        <input type="file" class="form-control" id="fileRight" required/>
                                        <label class="input-group-text" for="fileRight">Upload</label>
                                    </div> -->
                        <!-- button -->
                    </form>

                    <script>
        // Fungsi tambah hari kerja (skip Sabtu & Minggu)
        function addBusinessDays(startDate, days) {
            let date = new Date(startDate);
            let count = 0;
            while (count < days) {
                date.setDate(date.getDate() + 1);
                if (date.getDay() !== 0 && date.getDay() !== 6) {
                    count++;
                }
            }
            return date.toISOString().split('T')[0];
        }

        // Hitung due date otomatis saat claim_date berubah
        document.getElementById('claim_date').addEventListener('change', function () {
            const claimDate = this.value;
            if (claimDate) {
                const dueDate = addBusinessDays(claimDate, 3);
                document.getElementById('due_date').value = dueDate;
            } else {
                document.getElementById('due_date').value = '';
            }
        });

        // Otomatis isi claim_inisiator saat pilih tipe Pro Active Claim
        document.getElementById('claim_type').addEventListener('change', function () {
            const claimType = this.value;
            if (claimType === "Pro Active Claim") {
                const today = new Date();
                const dd = String(today.getDate()).padStart(2, '0');
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const yy = String(today.getFullYear()).slice(2, 4);
                const generated = `004205/ATMi-Klaim/${dd}/${mm}/${yy}`;
                document.getElementById('claim_inisiator').value = generated;
            } else {
                // Kalau bukan Pro Active Claim, biarkan manual isi, jangan reset otomatis
                // Jadi tidak melakukan apapun di sini
            }
        });
    </script>


    </main>
    <!--end::App Main-->

    {% include 'footer.html' %}